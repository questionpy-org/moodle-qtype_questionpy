define("qtype_questionpy/package_search/mutations",["exports","core/ajax","core/notification"],(function(_exports,_ajax,_notification){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_ajax=_interopRequireDefault(_ajax),_notification=_interopRequireDefault(_notification);return _exports.default=class{constructor(options){this.options=options}_setLoading(stateManager,loading){stateManager.setReadOnly(!1),stateManager.state.general.loading=loading,stateManager.setReadOnly(!0)}_getSearchPackagesInCategoriesPromise(args){let clonedArgs={...args},methods=[];for(var _len=arguments.length,categories=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)categories[_key-1]=arguments[_key];for(const category of categories){let method={methodname:"qtype_questionpy_search_packages",args:clonedArgs};method.args.category=category,methods.push(method),clonedArgs={...args}}return _ajax.default.call(methods)}async searchPackages(stateManager){let args=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const state=stateManager.state;args=args||{};let mergedArgs={query:args.query||state.general.query,tags:[],sort:args.sort||state.general.sort,order:args.order||state.general.order,limit:this.options.limit,page:0,contextid:this.options.contextid};this._setLoading(stateManager,!0);try{let[all,recentlyused,favourites,mine]=await this._getSearchPackagesInCategoriesPromise(mergedArgs,"all","recentlyused","favourites","mine");stateManager.setReadOnly(!1),state.all.data=await all,state.recentlyused.data=await recentlyused,state.favourites.data=await favourites,state.mine.data=await mine,stateManager.setReadOnly(!0)}catch(exception){await _notification.default.exception(exception)}this._setLoading(stateManager,!1)}async searchPackagesByQuery(stateManager,query){await this.searchPackages(stateManager,{query:query})}},_exports.default}));

//# sourceMappingURL=mutations.min.js.map